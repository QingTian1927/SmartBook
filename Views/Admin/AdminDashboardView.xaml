<Page x:Class="SmartBook.Views.Admin.AdminDashboardView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:views="clr-namespace:SmartBook.Views.Components"
      Title="Admin Dashboard"
      Background="White"
      Loaded="Page_Loaded">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <views:SidebarView Grid.Column="0" CurrentUsername="{Binding CurrentUsername}" />

        <!-- Main content -->
        <StackPanel Grid.Column="1" Margin="0" Background="White">
            <!-- Header -->
            <StackPanel Orientation="Horizontal" Margin="20,24,0,16">
                <TextBlock FontSize="24" FontWeight="Bold" Foreground="#253858" 
                           Text="Admin Dashboard" VerticalAlignment="Center"/>
            </StackPanel>

            <!-- Stats summary cards -->
            <WrapPanel x:Name="SummaryCardsPanel"
                       Margin="20,0,0,8" 
                       HorizontalAlignment="Left" 
                       ItemHeight="96"
                       ItemWidth="216"
                       Width="Auto">
                <!-- Card Example (repeat for each stat, or use ItemsControl + binding!) -->
                <Border Background="#F9F9F9" BorderBrush="#DDD" BorderThickness="1"
                        CornerRadius="8" Margin="0,0,16,16" Width="200" Height="96">
                    <StackPanel Orientation="Vertical" Margin="15">
                        <TextBlock Text="Total Users" Foreground="#888" FontWeight="SemiBold" FontSize="12" />
                        <TextBlock Text="{Binding Statistics.TotalUsers}" FontSize="28" FontWeight="Bold" Foreground="#1E2D40" />
                    </StackPanel>
                </Border>
                <Border Background="#F9F9F9" BorderBrush="#DDD" BorderThickness="1" CornerRadius="8" Margin="0,0,16,16" Width="200" Height="96">
                    <StackPanel Margin="15">
                        <TextBlock Text="Banned Users" Foreground="#888" FontWeight="SemiBold" FontSize="12" />
                        <TextBlock Text="{Binding Statistics.BannedUsers}" FontSize="28" FontWeight="Bold" Foreground="#D7263D" />
                    </StackPanel>
                </Border>
                <Border Background="#F9F9F9" BorderBrush="#DDD" BorderThickness="1" CornerRadius="8" Margin="0,0,16,16" Width="200" Height="96">
                    <StackPanel Margin="15">
                        <TextBlock Text="Total Books" Foreground="#888" FontWeight="SemiBold" FontSize="12" />
                        <TextBlock Text="{Binding Statistics.TotalBooks}" FontSize="28" FontWeight="Bold" Foreground="#1E9456" />
                    </StackPanel>
                </Border>
                <Border Background="#F9F9F9" BorderBrush="#DDD" BorderThickness="1" CornerRadius="8" Margin="0,0,16,16" Width="200" Height="96">
                    <StackPanel Margin="15">
                        <TextBlock Text="Total Authors" Foreground="#888" FontWeight="SemiBold" FontSize="12" />
                        <TextBlock Text="{Binding Statistics.TotalAuthors}" FontSize="28" FontWeight="Bold" Foreground="#264C74" />
                    </StackPanel>
                </Border>
                <Border Background="#F9F9F9" BorderBrush="#DDD" BorderThickness="1" CornerRadius="8" Margin="0,0,16,16" Width="200" Height="96">
                    <StackPanel Margin="15">
                        <TextBlock Text="Categories" Foreground="#888" FontWeight="SemiBold" FontSize="12"/>
                        <TextBlock Text="{Binding Statistics.TotalCategories}" FontSize="28" FontWeight="Bold" Foreground="#8D46A1" />
                    </StackPanel>
                </Border>
                <Border Background="#F9F9F9" BorderBrush="#DDD" BorderThickness="1" CornerRadius="8" Margin="0,0,16,16" Width="200" Height="96">
                    <StackPanel Margin="15">
                        <TextBlock Text="Books Read" Foreground="#888" FontWeight="SemiBold" FontSize="12"/>
                        <TextBlock Text="{Binding Statistics.BooksReadCount}" FontSize="28" FontWeight="Bold" Foreground="#286E82"/>
                    </StackPanel>
                </Border>
                <Border Background="#F9F9F9" BorderBrush="#DDD" BorderThickness="1" CornerRadius="8" Margin="0,0,16,16" Width="200" Height="96">
                    <StackPanel Margin="15">
                        <TextBlock Text="Avg. Rating" Foreground="#888" FontWeight="SemiBold" FontSize="12"/>
                        <TextBlock Text="{Binding Statistics.AverageBookRating, StringFormat=F2}" FontSize="28" FontWeight="Bold" Foreground="#E2B017"/>
                    </StackPanel>
                </Border>
                <!-- Edit Requests -->
                <Border Background="#FFF4F2" BorderBrush="#FFD4CC" BorderThickness="1" CornerRadius="8" Margin="0,0,16,16" Width="200" Height="96">
                    <StackPanel Margin="15">
                        <TextBlock Text="Pending Author Edits" Foreground="#D7263D" FontWeight="SemiBold" FontSize="12"/>
                        <TextBlock Text="{Binding Statistics.PendingAuthorEditRequests}" FontSize="28" FontWeight="Bold" Foreground="#D7263D"/>
                    </StackPanel>
                </Border>
                <Border Background="#F2FAFF" BorderBrush="#C9E5F6" BorderThickness="1" CornerRadius="8" Margin="0,0,16,16" Width="200" Height="96">
                    <StackPanel Margin="15">
                        <TextBlock Text="Pending Category Edits" Foreground="#0099CC" FontWeight="SemiBold" FontSize="12"/>
                        <TextBlock Text="{Binding Statistics.PendingCategoryEditRequests}" FontSize="28" FontWeight="Bold" Foreground="#0099CC"/>
                    </StackPanel>
                </Border>
            </WrapPanel>

            <!-- Tables: Top Books & Users -->
            <Grid Margin="20,12,20,16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="20" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <!-- Top Books -->
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Top Books" FontWeight="Bold" FontSize="16" Margin="0,0,0,8"/>
                    <DataGrid
                        ItemsSource="{Binding Statistics.TopBooks}"
                        AutoGenerateColumns="False"
                        CanUserAddRows="False"
                        CanUserDeleteRows="False"
                        IsReadOnly="True"
                        RowHeight="32"
                        MinHeight="130"
                        Height="180"
                        HeadersVisibility="Column"
                        FontSize="13"
                        BorderBrush="#DDD" BorderThickness="1"
                        Margin="0 0 18 0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Title" Binding="{Binding Title}" Width="*" />
                            <DataGridTextColumn Header="Author" Binding="{Binding AuthorName}" Width="120" />
                            <DataGridTextColumn Header="Read #" Binding="{Binding ReaderCount}" Width="60" />
                            <DataGridTextColumn Header="Avg. Rating" Binding="{Binding AverageRating, StringFormat=F2}" Width="80" />
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
                <StackPanel Grid.Column="2">
                    <TextBlock Text="Top Users" FontWeight="Bold" FontSize="16" Margin="0,0,0,8"/>
                    <DataGrid
                        ItemsSource="{Binding Statistics.TopUsers}"
                        AutoGenerateColumns="False"
                        CanUserAddRows="False"
                        CanUserDeleteRows="False"
                        IsReadOnly="True"
                        RowHeight="32"
                        MinHeight="130"
                        Height="180"
                        HeadersVisibility="Column"
                        FontSize="13"
                        BorderBrush="#DDD" BorderThickness="1"
                        Margin="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Username" Binding="{Binding Username}" Width="*" />
                            <DataGridTextColumn Header="Books Read" Binding="{Binding ReadBooksCount}" Width="80" />
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Grid>
            <!-- Spacer -->
            <DockPanel Height="24"/>
        </StackPanel>
    </Grid>
</Page>
